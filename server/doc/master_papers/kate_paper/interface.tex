\section{ Задача предоставления информации}

Информация, хранящаяся на сервере, предоставляется двумя способами --- в виде HTML для пользователей, желающих использовать web-browser, и по протоколу OPDS --- для клиентских программ. Фреймворк Django, использованный для реализации приложения, позволяет использовать очень высокий уровень абстракции.

\subsection{Концепция Модель - Представление - Управление в Django}

Главной идеей в Django является разделение задач \cite{mvc-djangobook}. Каждая задача выделена в отдельный файл:

\begin{enumerate}
	\item Файл models.py содержит описание таблицы базы данных, представленное в виде класса Python. 

{
\small \begin{verbatim}	
	from django.db import models

class Book(models.Model):
    title = models.CharField(max_length=NAME_LENGTH)
    author = models.ManyToManyField(Author, null=True, blank=True)
\end{verbatim}	
}	
	
	Такой класс называется моделью. С помощью данного класса можно создавать, получать, обновлять и удалять записи в таблице базы данных, используя простой код на языке Python вместо использования повторяющихся SQL команд.

	\item Файл views.py содержит логику отображения страницы. В этом файле содержатся функции, которым передается URL запрос. Такие функции называются представлением.
	
{
\small \begin{verbatim}	
	from django.shortcuts import render_to_response

def simple_search(request):
    """ simple search """
    query = request.GET["query"]
    if not query:
        return no_results(request)
    books = SEARCH_ENGINE.simple_search(query)
    return render_response(request,
        'book/search_response.xml', {'books': books })
\end{verbatim}	
}

	\item Файл urls.py определяет какое именно представление будет вызвано для URL, заданного в виде шаблона. 

{
\small \begin{verbatim}	

from django.conf.urls.defaults import *
import views

urlpatterns = patterns("",
    (r"^simple_search/?", views.simple_search),
)
\end{verbatim}	
}	
	
	\item Так же есть файлы-шаблоны, которые описывают дизайн страницы. Эти файлы используют свой шаблонный язык.
\end{enumerate}

{
    \small \begin{verbatim}	

    <html>
      <head><title>Книги</title></head>
      <body>
      <h1>Книги</h1>
      <ul>
      {% for book in book_list %}
        <li>{{ book.title }}</li>
      {% endfor %}
      </ul>
      </body></html>
\end{verbatim}	
}


 Объединённые вместе, эти компоненты приложения следуют шаблону Модель - Представление - Управление  (Model-View-Controller, MVC) \cite{mvc}. MVC определяет способ разработки программного обеспечения при котором код для определения и доступа к данным (модель) отделён от логики приложения (управление), которая в свою очередь отделена от интерфейса пользователя (представление). В этой концепции термин «Модель» относится к логике доступа к данным; термин «Представление» относится к той части системы, которая определяет, что показать и как; а термин «Управление» относится к той части системы, которая определяет какое представление надо использовать, в зависимости от пользовательского ввода, по необходимости получая доступ к модели. 

Шаблон Django — это строка текста, которая предназначена для отделения представления документа от его данных. Шаблон определяет места подстановки и различные виды основной логики (шаблонные теги), которая управляет отображением документа. Обычно, шаблоны используются для создания HTML, но шаблоны Django также способны участвовать в генерации любого текстового формата.

Основное преимущество такого подхода заключается в свободе объединения этих компонентов. Следовательно, каждая отдельная часть приложения, созданного с помощью Django, имеет одно назначение и может быть изменена независимо, т.е., без влияния на остальные компоненты. Например, разработчик может изменить URL для данной части приложения без изменения остального кода. Дизайнер может изменить HTML страницы без внесения изменений в код, который отображает страницу. Администратор базы данных может переименовать таблицу и определить эти изменения в одном месте, вместо того, чтобы искать и вносить изменения во множество файлов.

Таким образом, для того, чтобы реализовать два способа предоставления информации, достаточно было для каждой страницы описать по два файла-шаблона (для HTML и для OPDS) и назначить URL-связыва\-ние. Логика отображения страницы, которая описывается в файле views.py, для обоих представлений одинкова и не зависит от способов отображения этой информации, которые описывается в файлах-шаблонах.

\subsection{Абстракция от поискового механизма}

Кроме возможности просмотра каталогов, сервер так же предоставляет пользователям возможность простого и расширенного поиска. С этим связана вторая использованная абстракция --- это абстракция от поискового механизма. 

Сервер предоставляет пользователю возможность простого и расширенного поиска по книгам. Для улучшения поиска используются различные техники, улучшающие сам поиск, такие как soundex, исправление опечаток и др. %какие?? 

При обработке запроса используется абстракция SEARCH\_ENGINE, которая помогает работать с поиском не зависимо от того, какой механизм используется.

Реализованные возможности предоставления информации:
\begin{enumerate}
	\item Каталог. В каталоге реализованы различные разбиения множества книг --- по авторам ( внутри разбиение по первым 1/2 буквам имени), языкам, жанрам.
	\item Простой поиск --- при выводе результатов поиска вначале есть ссылки на авторов, если в запросе было слово, похожее на автора.
	\item Расширенный поиск --- позволяет искать отдельно по заголовку, имени автора, языку, жанру. Если поиск производится только по авторам --- выдается список авторов (ссылки на cтраницу с информацией об авторе ), иначе --- список книг, удовлетворяющих условиям поиска.
\item Вывод информации об отдельной книге.
\item Вывод информации об авторе и список ассоциированных с ним книг.
\item Корректирование запроса пользователя (Подсказка в виде <<did you mean?>>).
\end{enumerate}


\newpage