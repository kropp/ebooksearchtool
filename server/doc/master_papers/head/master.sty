\NeedsTeXFormat{LaTeX2e}
\ProvidesClass{master}[2008/06/01]

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% define if \ifpdf
\RequirePackage{ifpdf}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%For ViM error parser. Forbid all output messages. 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\renewcommand{\typeout}[1]{}
\renewcommand{\message}[1]{}                            
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% ENCODINGS
\ifpdf
    \RequirePackage{cmap}
\fi

\RequirePackage[utf8x]{inputenc}
\RequirePackage[T1,T2A]{fontenc}
%% LANGUAGES
\RequirePackage[english,russian]{babel}
%% MATH
\RequirePackage{amsmath, amsthm}
%% FONTS
\RequirePackage[psamsfonts]{amsfonts,amssymb} %Math packages
\RequirePackage{mathrsfs}
%\RequirePackage{beton}
%\RequirePackage{concrete}
%\RequirePackage{concmath}
%\RequirePackage{euler}
%% PICTURES
\ifpdf
    \RequirePackage[pdftex]{color}
    \RequirePackage[pdftex]{graphicx}
    \def\pgfsysdriver{pgfsys-pdftex.def}
\else
%    \RequirePackage{psfrag}
    \RequirePackage[dvips]{color}
    \RequirePackage[dvips]{graphicx}
\fi
%\RequirePackage{subfigure}
\RequirePackage{tikz}
\RequirePackage{array}
\RequirePackage{algorithmic}
%% CALCULATOR
\RequirePackage{calc}
%% STYLE
\RequirePackage[raggedright,small]{titlesec}
\RequirePackage[dotinlabels]{titletoc}
\titlelabel{\thetitle.\quad\thispagestyle{fancy}}
%% Puts "." instead of ":" in captions
\RequirePackage{ccaption}
\captiondelim{. }

\RequirePackage{indentfirst}
%% OTHER

\ifpdf
    \RequirePackage[bookmarks=false, a4paper, colorlinks, unicode, pdfstartview=FitH, pdftex]{hyperref}
    \hypersetup{ 
     plainpages=true,
     linkcolor=blue,
     citecolor=red,
     menucolor=blue,
     pdfnewwindow=true
    }
\else
    \RequirePackage[bookmarks=false, colorlinks, unicode,
                    pdfstartview=FitH]{hyperref}
\fi
               
\RequirePackage{xspace}
\RequirePackage{remreset}
%%
\RequirePackage[a4paper,top=2.5cm,bottom=2.5cm,left=2.5cm,
                right=1cm,head=17pt]{geometry}
%%
%\RequirePackage{listings}
%\lstset{language=c++,extendedchars=true,%
%    basicstyle=\ttfamily,%
%    keywordstyle=\bfseries\color[rgb]{0,0,0.5},%
%    commentstyle=\color[rgb]{0.5,0.5,0.5},%
%    stringstyle=\color[rgb]{0,0.5,0},%
%    identifierstyle=,%
%    breaklines=true,
%    showstringspaces=false}
%%

%%%%%%%%%%
%HEADINGS%
%%%%%%%%%%
\RequirePackage{fancyhdr}

\pagestyle{fancy}
\renewcommand{\headrulewidth}{0pt}%
\renewcommand{\footrulewidth}{0pt}%
\fancyhf{}
\cfoot{\arabic{page}}

\fancypagestyle{plain}{\thispagestyle{fancy}}

%%%%%%%%%%
%%%%%%%%%%
%%%Запрещает висячие строки
\clubpenalty=10000
\widowpenalty=10000

\lccode`\-=`\-
\lccode`\+=`\+
\defaulthyphenchar=127
\hfuzz=1.5pt

\newcommand{\lets}{\hbox{\rlap{$\urcorner$}$\lrcorner$}\xspace}
\newcommand{\letsee}{\sphericalangle}
\newcommand{\nat}{\mathbb{N}}
\newcommand{\integer}{\mathbb{Z}}
\newcommand{\real}{\mathbb{R}}
%%%\dottedcontents
\newcommand{\stroka}{\vspace{\baselineskip}}
\newcommand{\te}{т.\,е.\xspace}
\newcommand{\td}{т.\,д.\xspace}
\newcommand{\tk}{т.\,к.\xspace}
\newcommand{\tp}{т.\,п.\xspace}
%%
\newcommand{\picref}[1]{рис.~\ref{#1}}
\newcommand{\tabref}[1]{табл.~\ref{#1}}
%%%
\newcommand{\bls}[1]{\vspace{#1\baselineskip}}
%%
% theorems, etc.
\newtheorem{thm}{Теорема}
\newenvironment{algo}[1]{\par\medskip\noindent{\bf Алгоритм} 
                        {\sc #1}\par}{\medskip\par}
\newtheorem{lmm}{Лемма}
\newtheorem{csq}{Следствие}

\newcommand{\dost}{\par\vskip 1em {\em Достаточность.}\xspace}
\newcommand{\neob}{\par\vskip 1em {\em Необходимость.}\xspace}

\newcommand{\term}[1]{\emph{#1}}
\newcommand{\name}[1]{{\bf #1}}
\newenvironment{definition}{\smallskip\par\noindent{\bf
Определение.}}{\smallskip\par}

\renewenvironment{proof}{\begin{trivlist} \item[\hskip \labelsep {\bfseries Доказательство.}]}
{\qed\end{trivlist}}

\newcommand{\EQ}{\quad\Leftrightarrow\quad}
\newcommand{\TN}{\quad\Rightarrow\quad}

%% NUMBER SETS
\newcommand{\Nat}{\mathbb{N}}
\newcommand{\Int}{\mathbb{Z}}

%% FOR TIKZ
\tikzstyle{vertex} = [circle,fill=black!10,draw,minimum size=15pt,
                      inner sep=0pt, thick]
\tikzstyle{edge}   = [draw,-,thick]
\tikzstyle{vlabel} = [minimum size=15pt,inner sep=0pt]

%% ABBREVIATURES
\newcommand{\mnp}{\mathcal{NP}}
\newcommand{\np}{$\mnp$\xspace}
\newcommand{\mconp}{co\mnp}
\newcommand{\conp}{$\mconp$\xspace}
\newcommand{\pnnp}{$\mathcal{P}\neq\mathcal{NP}$\xspace}
\newcommand{\SAT}{\textsc{SAT}\xspace}
\newcommand{\PHP}{\textsc{PHP}\xspace}
\newcommand{\PHPs}[2]{$\textsc{PHP}_{#1}^{#2}$}

%%
\newcommand{\ceil}[1]{\lceil#1\rceil}
\newcommand{\floor}[1]{\lfloor#1\rfloor}
%%

\makeatletter
\@removefromreset{table}{chapter}
\@removefromreset{figure}{chapter}
\makeatother
\renewcommand{\thetable}{\arabic{table}}
\renewcommand{\thefigure}{\arabic{figure}}

\newcommand{\figref}[1]{рис.~\ref{#1}}
\renewcommand{\arraystretch}{1.5}

\makeatletter
\renewcommand{\@biblabel}[1]{#1.}
\makeatother

\newcommand{\chapname}{\chaptername}
\newcommand{\isappendix}{0}
%% Сперто из report.cls и подправлено
\newcommand{\numchap}[2][default]{%
        \refstepcounter{chapter}%
        \ifnum\isappendix=0
            \addcontentsline{toc}{chapter}{\hbox to 4em{\chapname~\thechapter.\hfill\mbox{}} #1}%
        \else
            \addcontentsline{toc}{chapter}{\hbox to 7.2em{\chapname~\thechapter.\hfill\mbox{}} #1}%
        \fi
    {\raggedright\Large\bfseries\setlength{\baselineskip}{1.5em}\chapname~\thechapter.\medskip\par#2\vskip1em\par}%
}
\newcommand{\numlesschap}[1]{
    \addcontentsline{toc}{chapter}{#1}%
    {\raggedright\Large\bfseries\setlength{\baselineskip}{1.5em}#1\vskip1em\par}%
}

\makeatletter
\renewcommand{\chapter}{
    \if@openright\cleardoublepage\else\clearpage\fi
                    \thispagestyle{plain}%
                    \global\@topnum\z@
                    \@afterindentfalse
            \mbox{}\bigskip\par
    \secdef\numchap\numlesschap
}

\newcommand{\numlesschapter}[1]{%
    \if@openright\cleardoublepage\else\clearpage\fi
                    \thispagestyle{plain}%
                    \global\@topnum\z@
                    \@afterindentfalse
            \mbox{}\bigskip\par
    {\raggedright\Large\bfseries\setlength{\baselineskip}{1.5em}#1\vskip1em\par}%
}

\renewcommand\tableofcontents{%
    \if@twocolumn
      \@restonecoltrue\onecolumn
    \else
      \@restonecolfalse
    \fi
    \numlesschapter{\contentsname
        \@mkboth{%
           \MakeUppercase\contentsname}{\MakeUppercase\contentsname}}%
    \@starttoc{toc}%
    \if@restonecol\twocolumn\fi
}
\makeatother

\renewcommand{\appendix}{%
    \setcounter{chapter}{0}%                                                       
    \renewcommand{\chapname}{\appendixname}%
    \renewcommand{\isappendix}{1}%
}

\newenvironment{where}
{где
\begin{list}{}{%
    \setlength{\parsep}{0pt}
    \setlength{\topsep}{0pt}
    \setlength{\partopsep}{0pt}
    \setlength{\itemsep}{0pt}
    \setlength{\leftmargin}{3em}
    \setlength{\parskip}{0pt}
    \setlength{\labelwidth}{2.5em}
    \setlength{\labelsep}{.5em}
    \setlength{\itemindent}{0em}
    \setlength{\listparindent}{0pt}
}}{\end{list}}

\newcommand{\includegraphicsext}[3]
{\ifpdf%
    \includegraphics[#1]{#3}%
 \else%
    \includegraphics[#1,#2]{#3}%
 \fi%
}

\newcommand{\includegraphicseps}[3]
{\ifpdf%
    \includegraphics[#1]{#3.pdf}%
 \else%
	#2%
    \includegraphics[#1]{#3.eps}%
 \fi%
}


\AtBeginDocument{%
\renewcommand{\bibname}{Список литературы}%
\renewcommand{\contentsname}{Содержание}%
\setlength{\baselineskip}{1.5em}%
\setlength{\parindent}{5ex}%
}
