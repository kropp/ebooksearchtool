<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head profile="http://www.w3.org/1999/xhtml/vocab">
    <title>Search results for: 
    {% if title.query %}
        Query "{{ title.query }}";
    {% endif %}
    {% if title.tit %}
        Title "{{ title.tit }}";
    {% endif %} 
    {% if title.author %}
        Author "{{ title.author }}";
    {% endif %}
    {% if title.lang %}
        Language "{{ title.lang }}";
    {% endif %}
    {% if title.tag %}
        Tag "{{ title.tag }}";
    {% endif %}
    </title>

<style type="text/css">
    
    img.cover {margin-top: 3px; max-height: 110px;}

</style>
 
  
  <meta http-equiv="content-type" content="application/xhtml+xml; charset=utf-8" />
  
  <!-- Links --> 
  <link rel="search" type="application/opensearchdescription+xml" title="Opensearch description" href="opensearch" />

  <!-- CSS 
  <link rel="stylesheet" href="/stylesheets/screen.css" type="text/css" media="screen, projection" /> 
  <link rel="stylesheet" href="/stylesheets/print.css" type="text/css" media="print" /> 
  <link href="/stylesheets/normal.css?1255441690" media="screen" rel="stylesheet" type="text/css" />
  -->
  
</head>


<body>

<div id="header">
  
    <div class="container">
        <div>
            <h1>Search results for: </h1>
        </div>
            <form name="test" action="search">
                {% if title.query %}
                Query: <input type="text" name="query" value="{{ title.query }}">
                <input type="submit" value="Search" >
                <a href="discover/extended" rel="extended">Extended search</a>
               
                {% else %}
                <table>    
                    <tr>
                    <td>Title:</td>
                    <td>  <input type="text" name="title" value="{{ title.tit }}"></td>
                    <td><a href="discover/search" rel="simple search">Simple search</a> </td>
                    </tr><tr>
                    <td>Author:</td> 
                    <td> <input type="text" name="author" value="{{ title.author }}"></td>
                    </tr><tr>
                    <td>Language:</td>  
                    <td><input type="text" name="lang" value="{{ title.lang }}"></td>
                    </tr><tr>
                    <td>Tag:</td>
                    <td><input type="text" name="tag" value="{{ title.tag }}"></td>
                     </tr><tr>
                     <td></td><td align="right"><input type="submit" value="Search" ></td>
                </table>
                </form>
                    
                {% endif %}
                </form><br/>
    </div>


{% if authors %}
<h2>Found in authors:</h2>
{% for author in authors %}
<div>
<span>
    <a href="author/id{{ author.id }}" class="gray">{{ author.name }}</a></em>
</span>
</div>
{% endfor %}
{% endif %}

{% if books %}
<h2>Found in books:</h2>
{% for book in books %}

<hr class="space" />

<div>

<span>
      {% if not book.book_file.all.0.img_link %}
        <a href="book/id{{ book.id }}"><img alt="{{ book.title }}" class="cover" align="left" border="0" hspace="10" src="http://abyss.hubbe.net/gfx/covers/no_cover.gif" title="{{ book.title }}" /></a>
      {% else %}
        <a href="book/id{{ book.id }}"><img alt="{{ book.title }}" class="cover" align="left" border="0" hspace="10"  src="{{book.book_file.all.0.img_link}}" title="{{ book.title }}" /></a> 
      {% endif %}  



    <h3><a href="book/id{{ book.id }}">{{ book.title }}</a></h3>
    <h4>by 
      {% for author in book.author_set.all %}
         <em><a href="author/id{{ author.id }}" class="gray">{{ author.name }}</a></em>
      {% endfor %}
    </h4>    
    <div class="tags">
        <h4 class="charcoal">Tags:
        {% for tag in book.tag.all %}
            <em><a href="search?tag={{ tag }}" class="gray">{{ tag }}</a> </em>
        {% endfor %}
    </h4>
    </div>

    {% if book.lang %}
        <h4 class="charcoal">Language: <em><a href="search?lang={{ book.lang }}" class="gray">{{ book.lang }}</a>
        </em></h4>
    {% else %}
    <br/>
    {% endif %}
    {% if not book.annotation.all.0 %}
         <br/>
    {% else %}
        <annotation> {{ book.annotation.all.0 }} </annotation>
    {% endif %}
</span>
    
</div>

{% endfor %}
{% endif %}
<hr class="space" />

<!--    <link href="search.atom?" rel="alternate"></link>
    <link href="search.atom?items_per_page={{items_per_page}};query={{ query }}" rel="self"></link>
    <link rel="next" href="search.atom?page={{next}};items_per_page={{items_per_page}};query={{ query }}"/>
-->    

<div class="pagination" align="center">
{% ifnotequal prev 0 %}

{% if title.query %}
    <a href="search?page={{prev}};items_per_page={{items_per_page}};query={{ title.query }}" rel="prev">previous page</a>
{% else %}        
    {% if title.author and title.tit %}
        <a href="search?page={{prev}};items_per_page={{items_per_page}};author={{ title.author }};title={{ title.tit }}" rel="prev">previous page</a>
    {% else %}
        {% if not title.author and not title.tit %}
            {% if title.tag %}
                <a href="search?tag={{title.tag}};page={{prev}};items_per_page={{items_per_page}}" rel="prev">previous page</a>
            {% else %}
                {% if title.lang %}
                    <a href="search?lang={{title.lang}};page={{prev}};items_per_page={{items_per_page}}" rel="prev">previous page</a>            
                {% else %}    
                    <a href="all?page={{prev}};items_per_page={{items_per_page}}" rel="prev">previous page</a>            
                {% endif %}
            {% endif %}    

        {% else %}    
            {% if title.tit %}
                <a href="search?page={{prev}};items_per_page={{items_per_page}};title={{ title.tit }}" rel="prev">previous page</a>
            {% endif %}
            {% if title.author %}
                <a href="search?page={{prev}};items_per_page={{items_per_page}};author={{ title.author }}" rel="prev">previous page</a>
            {% endif %}
        {% endif %}
    {% endif %}
{% endif %}

{% endifnotequal %}

{% ifnotequal next 0 %}

{% for ind in seq %}
    {% ifequal ind curr %}
        <span class="current">{{curr}}</span>
    {% else %}
        {% if title.query %}
            <a href="search?page={{ind}};items_per_page={{items_per_page}};query={{ title.query }}" rel="self">{{ind}}</a>
        {% else %}        
            {% if title.author and title.tit %}
                <a href="search?page={{ind}};items_per_page={{items_per_page}};author={{ title.author }};title={{ title.tit }}" rel="self">{{ind}}</a>
            {% else %}
                {% if not title.author and not title.tit %}
                    {% if title.tag %}
                        <a href="search?tag={{title.tag}};page={{ind}};items_per_page={{items_per_page}}" rel="self">{{ind}}</a>
                    {% else %}
                        {% if title.lang %}
                            <a href="search?lang={{title.lang}};page={{ind}};items_per_page={{items_per_page}}" rel="self">{{ind}}</a>            
                        {% else %}    
                            <a href="all?page={{ ind }};items_per_page={{items_per_page}}" rel="self">{{ind}}</a>
                        {% endif %}
                    {% endif %} 
                {% else %}    
                    {% if title.tit %}
                        <a href="search?page={{ind}};items_per_page={{items_per_page}};title={{ title.tit }}" rel="self">{{ind}}</a>
                    {% endif %}
                    {% if title.author %}
                        <a href="search?page={{ind}};items_per_page={{items_per_page}};author={{ title.author }}" rel="self">{{ind}}</a>
                    {% endif %}
                {% endif %}
            {% endif %}
        {% endif %}
    {% endifequal %}
{%endfor%}


{% if title.query %}
    <a href="search?page={{next}};items_per_page={{items_per_page}};query={{ title.query }}" rel="next">next page</a>
{% else %}        
    {% if title.author and title.tit %}
        <a href="search?page={{next}};items_per_page={{items_per_page}};author={{ title.author }};title={{ title.tit }}" rel="next">next page</a>
    {% else %}
        {% if not title.author and not title.tit %}
            {% if title.tag %}
                <a href="search?tag={{title.tag}};page={{next}};items_per_page={{items_per_page}}" rel="next">next page</a>
            {% else %}
                {% if title.lang %}
                    <a href="search?lang={{title.lang}};page={{next}};items_per_page={{items_per_page}}" rel="prev">next page</a>            
                {% else %}    
                    <a href="all?page={{next}};items_per_page={{items_per_page}}" rel="next">next page</a>
                {% endif %} 
            {% endif %} 
        {% else %}    
            {% if title.tit %}
                <a href="search?page={{next}};items_per_page={{items_per_page}};title={{ title.tit }}" rel="next">next page</a>
            {% endif %}
            {% if title.author %}
                <a href="search?page={{next}};items_per_page={{items_per_page}};author={{ title.author }}" rel="next">next page</a>
            {% endif %}
        {% endif %}
    {% endif %}
{% endif %}

{% endifnotequal %}
</div>
</div>
</body>
</html>

