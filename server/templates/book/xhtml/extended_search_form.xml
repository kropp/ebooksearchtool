{% load i18n %}
<script type="text/javascript" src="{{MEDIA_URL}}/js/views/jQuery.js"></script>
<script type="text/javascript" src="{{MEDIA_URL}}/js/views/jquery-autocomplete/jquery.autocomplete.js"></script>
<link rel="stylesheet" type="text/css" href="{{MEDIA_URL}}/css/jquery.autocomplete.css" />
<div id="header">

<center><a href="/"><img alt="eBookSearch" border="0" hspace="10"  src="{{MEDIA_URL}}/pic/title.png" title="eBookSearch" /></a></center>
    <h2>{%trans "Extended search"%}</h2>
    <form name="extended_search" action="search">
    
        <table>    
            <tr><td>{%trans "Title"%}:</td>
            <td>  <input type="text" style="width: 253px;" name="title" id="id_title" value="{{ title.tit }}">
            <script type="text/javascript">function author_value() { return $('#id_author').val(); }
            $('#id_title').autocomplete("/extended_search/autocomplete_title", {
                "extraParams": {
                    "author": author_value
                }
            });</script></td>
            <td><input type="submit" value="Search" ></td>
            <td>&nbsp;&nbsp;<a href="simple_search" rel="simple search">Simple search</a></td>
            </tr><tr>
            <td>{%trans "Author"%}:</td> 
            <td> <input type="text" style="width: 253px;" name="author" value="{{ title.author }}" id="id_author"></td>
            <script type="text/javascript">function title_value() { return $('#id_title').val(); }
            $('#id_author').autocomplete("/extended_search/autocomplete_author", {
                "extraParams": {
                    "title": title_value
                }
            });</script>

            </tr><tr>
            <td style="padding-top: 20px;">{%trans "Language"%}:</td>  
            <td style="padding-top: 20px;"><select name="lang"  width="260" style="width: 260px">
                <option value="">--None--</option>
                {% ifequal "en" title.lang %}
                    <option selected value="en">English</option>
                    <option value="ru">Russian</option>
                    <option value="fr">French</option>
                    <option disabled>-----------</option> 
                    {% for lang in langs %}
                        <option value="{{lang.0}}">{{lang.1}}</option>
                    {% endfor %}
                {% else %}
                    {% ifequal "ru" title.lang %}
                        <option value="en">English</option>
                        <option selected value="ru">Russian</option>
                        <option value="fr">French</option>
                        <option disabled>-----------</option> 
                        {% for lang in langs %}
                            <option value="{{lang.0}}">{{lang.1}}</option>
                        {% endfor %}
                    {% else %}
                        {% ifequal "fr" title.lang %}
                            <option value="en">English</option>
                            <option value="ru">Russian</option>
                            <option selected value="fr">French</option>
                            <option disabled>-----------</option> 
                            {% for lang in langs %}
                                <option value="{{lang.0}}">{{lang.1}}</option>
                            {% endfor %}
                        {% else %}
                            <option value="en">English</option>
                            <option value="ru">Russian</option>
                            <option value="fr">French</option>
                            <option disabled>-----------</option>
                            {% for lang in langs %}
                                {% ifequal lang.0 title.lang %} 
                                    <option selected value="{{lang.0}}">{{lang.1}}</option>                    
                                {% else %}
                                <option value="{{lang.0}}">{{lang.1}}</option>
                                {% endifequal %}
                            {% endfor %}                            
                        {% endifequal %}
                    {% endifequal %}
                {% endifequal %}
                </select>
            </td>

            </tr><tr>
            <td>{%trans "Tag"%}:</td>
            <td><select name="tag"  width="260" style="width: 260px">
                <option value="">--None--</option>
                {% for tag in tags %}
                    {% ifequal tag.name title.tag %} 
                        <option selected value="{{tag.name}}">{{tag.name}}</option>
                    {% else %}
                        <option value="{{tag.name}}">{{tag.name}}</option>
                    {% endifequal %}
                {% endfor %}
                </select>
            </td>
             </tr>
        </table>
        {%if suggestions%}
            {%if suggestions.title%}
                {%if suggestions.author%}
                    <h4>{%trans "Did you mean"%}: <a href="search?author={{ suggestions.author }};title={{ suggestions.title }};lang={{title.lang}};tag={{title.tag}}" class="gray">{%trans "Title"%}: {{ suggestions.title }}  {%trans "Author"%}: {{ suggestions.author }}</a></em></h4>
                {%else%}
                <h4>{%trans "Did you mean"%}: <a href="search?author={{ title.author }};title={{ suggestions.title }};lang={{title.lang}};tag={{title.tag}}" class="gray">{%trans "Title"%}: {{ suggestions.title }}  {%trans "Author"%}: {{ title.author }}</a></em></h4>
                {%endif%}
            {%else%}
                {%if suggestions.author%}
                    <h4>Did you mean: <a href="search?author={{ suggestions.author }};title={{ title.tit }};lang={{title.lang}};tag={{title.tag}}" class="gray">{%trans "Title"%}: {{ title.tit }}  {%trans "Author"%}: {{ suggestions.author }}</a></em></h4>
                {%endif%}
            {%endif%}

        {%endif%}
        
    </form>

</div>

